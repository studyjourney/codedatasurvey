<!DOCTYPE html>
<html lang="en">

<head>
    <title>Code Data Survey</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- Favicons -->


    <!-- Custom styles for this template -->
    <link href="css/main.css" rel="stylesheet">
        </head>
        <body>
        
        <div class="bgimg-1">
          <div class="caption">
          <span class="border">Code Data Survey</span>
          </div>
        </div>
        
        <div style="color: #777;background-color:white;text-align:center;padding:50px 80px;text-align: justify;">
          <h3 style="text-align:center;">Help Us!</h3>
          <p>The Study Journey Project wants to make getting modules easier.</p>
        </div>
        
        
        <div style="position:relative;">
          <div style="color:#ddd;background-color:#282E34;text-align:center;padding:50px 80px;text-align: justify;">
          <!-- Placeholder functionality-only UI -->

<div id='welcome-div'>
    <a href='https://app.code.berlin/settings?table=api', target='_blank'>
        Get your token here
    </a>
    <br />
    <form id='token-form' action='/token'>
        <label>Token:</label>
        <br />
        <input type='password' id='token-input' />
        <br />
        I would like to give you the following anonymous data:
        <br />
        <input type='checkbox' id='assessments-checkbox' checked disabled /><label>Assessments history</label>
        <br />
        <input type='checkbox' id='current-semester-checkbox' checked /><label>Currently enrolled modules</label>
        <br />
        <input type='checkbox' id='events-checkbox' checked/><label>Events history</label>
        <br />
        <input type='checkbox' id='projects-checkbox' checked/><label>Projects history</label>
        <br />
        <input type='submit' value='Submit' />
    </form>
</div>
<div id='sending-div' style='display:none'>
    Processing...
</div>
<div id='success-div' style='display:none'>
    Thanks!
</div>
<div id='error-div' style='display:none'>
    Oops :(
</div>

<script type='text/javascript'>
    const welcomeDiv = document.getElementById('welcome-div')
    const sendingDiv = document.getElementById('sending-div')
    const successDiv = document.getElementById('success-div')
    const errorDiv = document.getElementById('error-div')
    document.getElementById('token-form').addEventListener('submit', e => {
        e.preventDefault()
        welcomeDiv.setAttribute('style', 'display:none')
        sendingDiv.setAttribute('style', 'display:block')
        fetch('/codeData', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                token: document.getElementById('token-input').value,
                permissions: {
                    currentSemester: document.getElementById('current-semester-checkbox').checked,
                    events: document.getElementById('events-checkbox').checked,
                    projects: document.getElementById('projects-checkbox').checked,
                }
            }),
        })
        .then(res => {
            if (res.status < 400) successDiv.setAttribute('style', 'display:block')
            else errorDiv.setAttribute('style', 'display:block')
        })
        .catch(() => {
            errorDiv.setAttribute('style', 'display:block')
        })
        .finally(() => {
            sendingDiv.setAttribute('style', 'display:none')
        })
    })
</script>
          </div>
        </div>
        
        
        <div class="bgimg-1">
          <div class="caption">
          <span class="border">COOL!</span>
          </div>
        </div>
    <!-- Footer -->
        <div style="color:#ddd;background-color:#282E34;text-align:center;padding:50px 80px;text-align: justify;">

        <p>Code Student Data Survey</p>
        <p>
            <a href="#">Study Journey Team</a> - Copyright 2020
        </p>
        </div>

</body>

</html>
